<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WEBVIEW'S ‚Äî Monitor Dashboard</title>
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="/frontend/monitor/index.css?v=20251208">
  <link rel="icon" href="/frontend/favicon.ico">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  
  <!-- ==================== HEADER ==================== -->
  <header>
    <div class="header-left">
      <div class="logo">
        <button class="toggle" id="toggleSidebar" aria-label="Toggle sidebar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"/>
            <line x1="3" y1="6" x2="21" y2="6"/>
            <line x1="3" y1="18" x2="21" y2="18"/>
          </svg>
        </button>
        
        <svg viewBox="0 0 40 40" class="logo-icon" width="28" height="28" aria-hidden="true">
          <defs>
            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
            </linearGradient>
          </defs>
          <polygon points="20,2 38,11 38,29 20,38 2,29 2,11" fill="none" stroke="url(#grad1)" stroke-width="1.5"/>
          <circle cx="20" cy="20" r="8" fill="none" stroke="url(#grad1)" stroke-width="1.5"/>
          <circle cx="20" cy="20" r="3" fill="url(#grad1)"/>
        </svg>
        
        <div class="logo-text">
          <span class="brand">WEBVIEW'S</span>
          <span class="tagline">ENERGY HUB</span>
        </div>
      </div>
    </div>
    
    <div class="header-right">
      <div class="pill" id="projName">‚Äî</div>
      <button class="btn" onclick="location.href='/frontend/user.html'">‚Üê Back</button>
    </div>
  </header>
  
  <!-- ==================== LAYOUT ==================== -->
  <div class="layout">
    
    <!-- ==================== SIDEBAR ==================== -->
    <aside class="sidebar" id="sidebar">
      
      <div class="section-title">Monitor</div>
      <a href="#" class="tile active" id="nav-dashboard">Dashboard</a>
      <a href="#" class="tile" id="nav-alarms">Alarms</a>
      <a href="#" class="tile" id="nav-trends">Trends</a>
      <a href="#" class="tile" id="nav-photo">Photo</a>
      
      <div class="section-title">Analyse</div>
      <a href="#" class="tile" id="nav-consumption">Consumption</a>
      
      <div class="section-title">Filters</div>
      <div class="tile">
        <details id="filters" open>
          <summary>Select Filters</summary>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
            <label style="font-size:11px;color:#94a3b8;">Converter</label>
            <select id="conv" class="select" aria-label="Select converter">
              <option value="">All</option>
            </select>
            
            <label style="font-size:11px;color:#94a3b8;">Device</label>
            <select id="dev" class="select" aria-label="Select device">
              <option value="">All</option>
            </select>
          </div>
        </details>
      </div>
      
    </aside>
    
    <!-- ==================== CONTENT ==================== -->
    <main class="content">
      
      <!-- ==================== TAB NAVIGATION ==================== -->
      <nav class="tab-nav" id="tabNav">
        <button class="tab-item active" data-tab="summary">
          <span>üìä</span>
          <span>Summary</span>
        </button>
        <button class="tab-item" data-tab="ui">
          <span>‚ö°</span>
          <span>U / I</span>
        </button>
        <button class="tab-item" data-tab="power">
          <span>üîå</span>
          <span>Power</span>
        </button>
        <button class="tab-item" data-tab="energy">
          <span>üîã</span>
          <span>Energy</span>
        </button>
        <button class="tab-item" data-tab="quality">
          <span>‚úì</span>
          <span>Quality</span>
        </button>
       
        <button class="tab-item" data-tab="overview">
          <span>üìà</span>
          <span>Overview</span>
        </button>
        
        <div class="tab-actions">
          <button class="action-btn primary" id="refreshBtn">
            <span>üîÑ</span>
            <span>Refresh</span>
          </button>
          <button class="action-btn" onclick="location.href='/frontend/user.html'">
            <span>‚Üê</span>
            <span>User Panel</span>
          </button>
        </div>
      </nav>
      
      <!-- ==================== DASHBOARD CONTENT ==================== -->
      <div id="dash-content">
        <div style="text-align:center;padding:80px 20px;color:#94a3b8;">
          <div style="font-size:48px;margin-bottom:20px;">‚ö°</div>
          <div style="font-size:18px;font-weight:600;color:#cbd5e1;margin-bottom:10px;">
            Loading Dashboard...
          </div>
          <div style="font-size:13px;opacity:0.7;">
            Please wait while we fetch your data
          </div>
        </div>
      </div>
      
    </main>
    
  </div>
  
  <!-- ==================== SCRIPTS ==================== -->
  <script src="monitor.js?v=20251208"></script>
  <script src="dashboard/tabs.js?v=20251208"></script>
  
  <script>
    // ==================== SIDEBAR TOGGLE ====================
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggleSidebar');
    
    function toggleSidebar() {
      sidebar.classList.toggle('collapsed');
      
      // Save state
      if (sidebar.classList.contains('collapsed')) {
        localStorage.setItem('sidebar-collapsed', 'true');
      } else {
        localStorage.removeItem('sidebar-collapsed');
      }
    }
    
    toggleBtn.addEventListener('click', toggleSidebar);
    
    // ==================== TAB SWITCHING ====================
    document.querySelectorAll('.tab-item').forEach(tab => {
      tab.addEventListener('click', function() {
        // Remove active from all
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        
        // Add active to clicked
        this.classList.add('active');
        
        // Get tab name
        const tabName = this.dataset.tab;
        console.log('Switching to tab:', tabName);
        
        // Trigger tab change
        if (window.TAB && window.TAB.switchTo) {
          window.TAB.switchTo(tabName);
        }
      });
    });
    
    // ==================== REFRESH BUTTON ====================
    document.getElementById('refreshBtn').addEventListener('click', function() {
      console.log('Refreshing dashboard...');
      
      this.style.opacity = '0.6';
      this.disabled = true;
      
      if (window.MON && window.MON.refresh) {
        window.MON.refresh();
      }
      
      setTimeout(() => {
        this.style.opacity = '1';
        this.disabled = false;
      }, 1000);
    });
    
    // ==================== INITIALIZE ====================
   // ==================== INITIALIZE ====================
    try { 
      if (window.MON && window.MON.init) {
        // ‚úÖ ‡∏£‡∏≠‡πÉ‡∏´‡πâ DOM ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', () => {
            MON.init();
          });
        } else {
          MON.init();
        }
      }
    } catch(e) {
      console.warn('MON.init failed:', e);
    }
    // ==================== RESTORE STATE ====================
    if (localStorage.getItem('sidebar-collapsed') === 'true') {
      sidebar.classList.add('collapsed');
    }
    
    // ==================== MOBILE AUTO-HIDE ====================
    if (window.innerWidth < 1024) {
      sidebar.classList.add('collapsed');
    } else {
      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏á collapsed ‡πÑ‡∏ß‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡∏±‡∏ö
      if (localStorage.getItem('sidebar-collapsed') !== 'true') {
        sidebar.classList.remove('collapsed');
      }
    }
    
    window.addEventListener('resize', () => {
      if (window.innerWidth < 1024) {
        sidebar.classList.add('collapsed');
      } else {
        if (localStorage.getItem('sidebar-collapsed') !== 'true') {
          sidebar.classList.remove('collapsed');
        }
      }
    });
  </script>
  
</body>
</html>
